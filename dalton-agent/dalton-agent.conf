# config file for Dalton agent 
#
# you really should only have to change SENSOR_UID and DALTON_API
# for your specific sensor and controller. The former can be set automatically by
# the agent in most cases; the latter will be set if used in the provided
# docker-compose file. 

[dalton]

DEBUG = False

# name of the sensor. If set to 'auto', will use hostname.
SENSOR_UID = auto

# Important! address of Dalton controller (i.e. where to get jobs, send results, etc.)
# Not expected to end with a slash. 
DALTON_API = http://dalton_web/dalton/sensor_api

# this is the API key the Dalton agent uses to authenticate to the controller
#  (authentication currently not implemented but the code expects a value to be passed)
API_KEY = bmV2ZXIgdW5kZXJlc3RpbWF0ZSB5b3VyIG9wcG9uZW50


# TODO: delete this
# Important! Sensor technology; the agent uses this value to alter its behavior as appropriate
# this should start with the engine name ('suricata' or 'snort'), followed by a dash followed
# by the version number.  This name must map directly to the engine configuration files on
# the Dalton controller. A value of 'auto' means that the agent will try to automatically
# determine this on startup (recommended). Examples:
# 'snort-2.9.9.0' for Snort 2.9.9.0; conf file 'snort-2.9.9.0.conf' on the Dalton controller
# 'suricata-4.0.0' for Suricata 4.0.0; conf file 'suricata-4.0.0.yaml' on the Dalton controller
SENSOR_TECHNOLOGY = auto

# if you have a specific config file you want the Controller to use for this Agent,
# specify a string here that will be passed to the Controller who will look
# for a config file with a corresponding filename (minus the extension and all lowercase).
# If set to "auto" then the
# config will be selected based on the engine (SENSOR_ENGINE) and version (SENSOR_VERSION).
# it will be passed to the controller 
SENSOR_CONFIG = auto


# this is where the sensor stores the job zip file, extracted files, job results files,
# and other temp files it may need.  Usually /tmp is fine but in case there isn't enough
# space there, change it here
STORAGE_PATH = /tmp

# number of seconds to wait between polling for new jobs (treated as integer)
POLL_INTERVAL = 1

# tcpdump used to analyze pcaps to provide feedback in case the submitter
#  did something like submit a pcap without a 3WHS
#  set to 'auto' to have agent find it on startup
TCPDUMP_BINARY = auto

# location of IDS engine (e.g. Suricata, Snort). If set to 'auto' the agent
# will attempt to find the binary 'suricata' or 'snort' on startup.
IDS_BINARY = auto

# True or False.  Keep the files used to run the job.  When an Agent
# receives a job, it extracts the files, builds the config accordingly,
# runs the jobs, sends the results back, and then cleans up by deleting
# all the files used for the job if this is set to False.  Set to True
# to keep the files (useful for debugging or seeing exactly what the
# sensor used to run a job).
KEEP_JOB_FILES = False

##### DO NOT CHANGE THESE #####
# Automatically determined at startup if set to 'auto, based on
# ouput from the binary at IDS_BINARY. if set to 'auto'.
# There may be some esoteric use cases where setting these
# makes sense but probably not; most likely you will break
# something and/or get unexpected results.  You've been
# warned (yet for some reason, these are still configurable,
# probably just to tempt you).
#
# "snort" or "suricata"
SENSOR_ENGINE = auto
# Suricata or Snort engine version, e.g. 4.1.4, 2.9.9.0
SENSOR_ENGINE_VERSION = auto
###############################
